{"version":3,"sources":["App.js","Weapons.js","index.js"],"names":["PixelPrice","BN","NearConfig","window","location","hostname","networkId","nodeUrl","contractName","walletUrl","Avocado","role","aria-label","className","Banana","Cucumber","Pepper","Berry","intToColor","c","toString","padStart","intToColorWithAlpha","a","Math","round","rgbaToInt","cr","cg","cb","ca","bgColor","bb","bg","br","imgColorToInt","int2hsv","cInt","substr","r","parseInt","g","b","v","max","min","h","transparentColor","generateGamma","hue","gammaColors","i","push","decodeLine","line","buf","Buffer","from","length","Error","pixels","color","readUInt32LE","ownerIndex","App","props","colors","map","toLowerCase","currentColor","substring","timeMs","Date","getTime","freeDrawingStartMsEstimated","OneDayMs","state","connected","signedIn","accountId","pendingPixels","boardLoaded","selectedCell","alpha","pickerColor","pickingColor","owners","accounts","highlightedAccountIndex","selectedOwnerIndex","farmingBanana","weaponsOn","weaponsCodePosition","freeDrawingStart","freeDrawingEnd","watchMode","_buttonDown","_oldCounts","_numFailedTxs","_balanceRefreshTimer","canvasRef","React","createRef","_context","_lines","_queue","_pendingPixels","_refreshBoardTimer","_sendQueueTimer","_stopRefreshTime","_accounts","_initNear","then","setState","_accountId","ircAccountId","replace","_freeDrawingStart","_freeDrawingEnd","hash","indexOf","setTimeout","enableWatchMode","canvas","this","current","getContext","click","rendering","drawImg","pickColor","saveColor","drawPixel","mouseMove","e","x","y","touches","rect","target","getBoundingClientRect","targetTouches","clientX","left","clientY","top","offsetX","offsetY","trunc","clientWidth","clientHeight","cell","JSON","stringify","renderCanvas","preventDefault","addEventListener","mouseDown","unselectCell","mouseUp","buttons","document","altKey","enablePickColor","key","disablePickColor","slice","_contract","draw","console","log","concat","Promise","all","refreshBoard","refreshAccountStats","forEach","p","_pending","ready","clearTimeout","_sendQueue","_pingQueue","balance","account","avocadoBalance","_isFreeDrawing","avocadoNeeded","img","imageData","w","width","height","d","Uint32Array","data","buffer","j","imgColor","account_id","accountIndex","account_index","parseFloat","avocado_balance","_pixelCost","bananaBalance","banana_balance","numPixels","num_pixels","farmingPreference","farming_preference","startTime","avocadoPixels","bananaPixels","avocadoRewardPerMs","bananaRewardPerMs","get_account","parseAccount","get_account_by_index","getAccount","clearInterval","setInterval","t","Object","assign","keyStore","nearAPI","BrowserLocalStorageKeyStore","deps","near","_keyStore","_near","_walletConnection","getAccountId","_account","viewMethods","changeMethods","get_pixel_cost","get_free_drawing_timestamp","freeDrawingTimestamp","_lineVersions","Array","fill","forced","hidden","get_line_versions","lineVersions","needLines","requestLines","lines","get_lines","results","flat","lineIndex","_refreshOwners","counts","sortedKeys","keys","sort","getAccountByIndex","ctx","fillStyle","fillRect","CellWidth","CellHeight","beginPath","strokeStyle","lineWidth","stroke","closePath","arc","PI","requestSignIn","signOut","rgb","changeColor","hsl","newColor","index","splice","hex","hsv","amount","requiredBalance","muln","buy_tokens","select_farming_preference","berry","date","body","style","transition","backgroundColor","watchClass","isFreeDrawing","freeDrawing","initialTime","direction","timeToUpdate","lastUnit","checkpoints","time","Fragment","Days","formatValue","Hours","Minutes","Seconds","Milliseconds","content","onClick","logOut","Balance","detailed","onChange","switchBerry","checked","offColor","onColor","uncheckedIcon","checkedIcon","buyTokens","hueColorChange","alphaColorChange","triangle","onChangeComplete","marginBottom","aria-hidden","weapons","renderIt","renderImg","href","ref","Leaderboard","setHover","title","frameBorder","src","allow","allowFullScreen","data-ribbon","Component","fraction","avacadoBalance","avocadoFarm","bananaFarm","toFixed","owner","Owner","isSelected","isHighlighted","onMouseEnter","onMouseLeave","Account","shortAccountId","Weapons","lockedAspect","sourceImage","Image","onload","clearRect","imageSmoothingQuality","drawImage","getImageData","reduce","sum","f","reader","FileReader","readAsDataURL","naturalWidth","naturalHeight","aspect","event","result","value","type","onFilesChange","onError","onFilesError","multiple","accepts","minFileSize","clickable","updateVal","changeLockedAspect","disabled","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.ca16ac09.chunk.js","sourcesContent":["import \"./App.scss\";\nimport \"./gh-fork-ribbon.css\";\nimport React from \"react\";\nimport BN from \"bn.js\";\nimport * as nearAPI from \"near-api-js\";\nimport { AlphaPicker, HuePicker, GithubPicker } from \"react-color\";\nimport Switch from \"react-switch\";\nimport { Weapons } from \"./Weapons\";\nimport Timer from \"react-compound-timer\";\n\nconst PixelPrice = new BN(\"10000000000000000000000\");\nconst IsMainnet = window.location.hostname === \"berryclub.io\";\nconst TestNearConfig = {\n  networkId: \"testnet\",\n  nodeUrl: \"https://rpc.testnet.near.org\",\n  contractName: \"berryclub.testnet\",\n  walletUrl: \"https://wallet.testnet.near.org\",\n};\nconst MainNearConfig = {\n  networkId: \"mainnet\",\n  nodeUrl: \"https://rpc.mainnet.near.org\",\n  contractName: \"berryclub.ek.near\",\n  walletUrl: \"https://wallet.near.org\",\n};\nconst NearConfig = IsMainnet ? MainNearConfig : TestNearConfig;\n\nconst Avocado = (\n  <span role=\"img\" aria-label=\"avocado\" className=\"berry\">\n    ü•ë\n  </span>\n);\nconst Banana = (\n  <span role=\"img\" aria-label=\"banana\" className=\"berry\">\n    üçå\n  </span>\n);\nconst Cucumber = (\n  <span role=\"img\" aria-label=\"cucumber\" className=\"berry\">\n    ü•í\n  </span>\n);\nconst Pepper = (\n  <span role=\"img\" aria-label=\"pepper\" className=\"berry\">\n    üå∂Ô∏è\n  </span>\n);\n\nconst Berry = {\n  Avocado: \"Avocado\",\n  Banana: \"Banana\",\n};\n\nconst BoardHeight = 50;\nconst BoardWidth = 50;\nconst NumLinesPerFetch = 10;\nconst ExpectedLineLength = 4 + 8 * BoardWidth;\nconst CellWidth = 12;\nconst CellHeight = 12;\nconst MaxNumColors = 31;\nconst BatchOfPixels = 100;\n// 500 ms\nconst BatchTimeout = 500;\nconst RefreshBoardTimeout = 1000;\nconst MaxWorkTime = 10 * 60 * 1000;\nconst OneDayMs = 24 * 60 * 60 * 1000;\n\nconst intToColor = (c) => `#${c.toString(16).padStart(6, \"0\")}`;\nconst intToColorWithAlpha = (c, a) =>\n  `#${c.toString(16).padStart(6, \"0\")}${Math.round(255 * a)\n    .toString(16)\n    .padStart(2, \"0\")}`;\n\nconst rgbaToInt = (cr, cg, cb, ca, bgColor) => {\n  const bb = bgColor & 255;\n  const bg = (bgColor >> 8) & 255;\n  const br = (bgColor >> 16) & 255;\n\n  const r = Math.round(cr * ca + br * (1 - ca));\n  const g = Math.round(cg * ca + bg * (1 - ca));\n  const b = Math.round(cb * ca + bb * (1 - ca));\n  return (r << 16) + (g << 8) + b;\n};\n\nconst imgColorToInt = (c, bgColor) => {\n  const cr = c & 255;\n  const cg = (c >> 8) & 255;\n  const cb = (c >> 16) & 255;\n  const ca = ((c >> 24) & 255) / 255;\n  return rgbaToInt(cr, cg, cb, ca, bgColor);\n};\n\nconst int2hsv = (cInt) => {\n  cInt = intToColor(cInt).substr(1);\n  const r = parseInt(cInt.substr(0, 2), 16) / 255;\n  const g = parseInt(cInt.substr(2, 2), 16) / 255;\n  const b = parseInt(cInt.substr(4, 2), 16) / 255;\n  let v = Math.max(r, g, b),\n    c = v - Math.min(r, g, b);\n  let h =\n    c && (v === r ? (g - b) / c : v === g ? 2 + (b - r) / c : 4 + (r - g) / c);\n  return [60 * (h < 0 ? h + 6 : h), v && c / v, v];\n};\nconst transparentColor = (c, a) =>\n  `rgba(${c >> 16}, ${(c >> 8) & 0xff}, ${c & 0xff}, ${a})`;\nconst generateGamma = (hue) => {\n  const gammaColors = [];\n  for (let i = 0; i < MaxNumColors; ++i) {\n    gammaColors.push(`hsl(${hue}, 100%, ${(100 * i) / (MaxNumColors - 1)}%)`);\n  }\n  return gammaColors;\n};\nconst decodeLine = (line) => {\n  let buf = Buffer.from(line, \"base64\");\n  if (buf.length !== ExpectedLineLength) {\n    throw new Error(\"Unexpected encoded line length\");\n  }\n  let pixels = [];\n  for (let i = 4; i < buf.length; i += 8) {\n    let color = buf.readUInt32LE(i);\n    let ownerIndex = buf.readUInt32LE(i + 4);\n    pixels.push({\n      color,\n      ownerIndex,\n    });\n  }\n  return pixels;\n};\n\nconst WeaponsCheat = \"idkfa\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const colors = [\n      \"#000000\",\n      \"#666666\",\n      \"#aaaaaa\",\n      \"#FFFFFF\",\n      \"#F44E3B\",\n      \"#D33115\",\n      \"#9F0500\",\n      \"#FE9200\",\n      \"#E27300\",\n      \"#C45100\",\n      \"#FCDC00\",\n      \"#FCC400\",\n      \"#FB9E00\",\n      \"#DBDF00\",\n      \"#B0BC00\",\n      \"#808900\",\n      \"#A4DD00\",\n      \"#68BC00\",\n      \"#194D33\",\n      \"#68CCCA\",\n      \"#16A5A5\",\n      \"#0C797D\",\n      \"#73D8FF\",\n      \"#009CE0\",\n      \"#0062B1\",\n      \"#AEA1FF\",\n      \"#7B64FF\",\n      \"#653294\",\n      \"#FDA1FF\",\n      \"#FA28FF\",\n      \"#AB149E\",\n    ].map((c) => c.toLowerCase());\n    // const currentColor = parseInt(colors[Math.floor(Math.random() * colors.length)].substring(1), 16);\n    const currentColor = parseInt(colors[0].substring(1), 16);\n    const defaultAlpha = 0.25;\n\n    const timeMs = new Date().getTime();\n    const freeDrawingStartMsEstimated =\n      timeMs -\n      ((timeMs - new Date(\"2021-05-09\")) % (7 * OneDayMs)) +\n      OneDayMs * 6;\n\n    this.state = {\n      connected: false,\n      signedIn: false,\n      accountId: null,\n      pendingPixels: 0,\n      boardLoaded: false,\n      selectedCell: null,\n      alpha: defaultAlpha,\n      currentColor,\n      pickerColor: intToColorWithAlpha(currentColor, defaultAlpha),\n      colors,\n      gammaColors: generateGamma(0),\n      pickingColor: false,\n      owners: [],\n      accounts: {},\n      highlightedAccountIndex: -1,\n      selectedOwnerIndex: false,\n      farmingBanana: false,\n      weaponsOn: false,\n      weaponsCodePosition: 0,\n      freeDrawingStart: new Date(freeDrawingStartMsEstimated),\n      freeDrawingEnd: new Date(freeDrawingStartMsEstimated + OneDayMs),\n      watchMode: false,\n    };\n\n    this._buttonDown = false;\n    this._oldCounts = {};\n    this._numFailedTxs = 0;\n    this._balanceRefreshTimer = null;\n    this.canvasRef = React.createRef();\n    this._context = false;\n    this._lines = false;\n    this._queue = [];\n    this._pendingPixels = [];\n    this._refreshBoardTimer = null;\n    this._sendQueueTimer = null;\n    this._stopRefreshTime = new Date().getTime() + MaxWorkTime;\n    this._accounts = {};\n\n    this._initNear().then(() => {\n      this.setState(\n        {\n          connected: true,\n          signedIn: !!this._accountId,\n          accountId: this._accountId,\n          ircAccountId: this._accountId.replace(\".\", \"_\"),\n          freeDrawingStart: this._freeDrawingStart,\n          freeDrawingEnd: this._freeDrawingEnd,\n        },\n        () => {\n          if (window.location.hash.indexOf(\"watch\") >= 0) {\n            setTimeout(() => this.enableWatchMode(), 500);\n          }\n        }\n      );\n    });\n  }\n\n  componentDidMount() {\n    const canvas = this.canvasRef.current;\n    this._context = canvas.getContext(\"2d\");\n\n    const click = async () => {\n      if (this.state.watchMode) {\n        return;\n      }\n      if (this.state.rendering) {\n        await this.drawImg(this.state.selectedCell);\n      } else if (this.state.pickingColor) {\n        this.pickColor(this.state.selectedCell);\n      } else {\n        this.saveColor();\n        await this.drawPixel(this.state.selectedCell);\n      }\n    };\n\n    const mouseMove = (e) => {\n      let x, y;\n      if (\"touches\" in e) {\n        if (e.touches.length > 1) {\n          return true;\n        } else {\n          const rect = e.target.getBoundingClientRect();\n          x = e.targetTouches[0].clientX - rect.left;\n          y = e.targetTouches[0].clientY - rect.top;\n        }\n      } else {\n        x = e.offsetX;\n        y = e.offsetY;\n      }\n      x = Math.trunc((x / e.target.clientWidth) * BoardWidth);\n      y = Math.trunc((y / e.target.clientHeight) * BoardWidth);\n      let cell = null;\n      if (x >= 0 && x < BoardWidth && y >= 0 && y < BoardHeight) {\n        cell = { x, y };\n      }\n      if (JSON.stringify(cell) !== JSON.stringify(this.state.selectedCell)) {\n        this.setState(\n          {\n            selectedCell: cell,\n            selectedOwnerIndex:\n              this._lines &&\n              cell &&\n              this._lines[cell.y] &&\n              this._lines[cell.y][cell.x].ownerIndex,\n          },\n          async () => {\n            this.renderCanvas();\n            if (this.state.selectedCell !== null && this._buttonDown) {\n              await click();\n            }\n          }\n        );\n      }\n      e.preventDefault();\n      return false;\n    };\n\n    canvas.addEventListener(\"mousemove\", mouseMove);\n    canvas.addEventListener(\"touchmove\", mouseMove);\n\n    const mouseDown = async (e) => {\n      this._buttonDown = true;\n      if (this.state.selectedCell !== null) {\n        await click();\n      }\n    };\n\n    canvas.addEventListener(\"mousedown\", mouseDown);\n    canvas.addEventListener(\"touchstart\", mouseDown);\n\n    const unselectCell = () => {\n      this.setState(\n        {\n          selectedCell: null,\n        },\n        () => this.renderCanvas()\n      );\n    };\n\n    const mouseUp = async (e) => {\n      this._buttonDown = false;\n      if (\"touches\" in e) {\n        unselectCell();\n      }\n    };\n\n    canvas.addEventListener(\"mouseup\", mouseUp);\n    canvas.addEventListener(\"touchend\", mouseUp);\n\n    canvas.addEventListener(\"mouseleave\", unselectCell);\n\n    canvas.addEventListener(\"mouseenter\", (e) => {\n      if (this._buttonDown) {\n        if (!(\"touches\" in e) && !(e.buttons & 1)) {\n          this._buttonDown = false;\n        }\n      }\n    });\n\n    document.addEventListener(\"keydown\", (e) => {\n      e.altKey && this.enablePickColor();\n    });\n\n    document.addEventListener(\"keyup\", (e) => {\n      if (this.state.weaponsCodePosition < WeaponsCheat.length) {\n        if (\n          e.key.toLowerCase() === WeaponsCheat[this.state.weaponsCodePosition]\n        ) {\n          this.setState({\n            weaponsCodePosition: this.state.weaponsCodePosition + 1,\n            weaponsOn:\n              this.state.weaponsCodePosition + 1 === WeaponsCheat.length,\n          });\n        } else {\n          this.setState({\n            weaponsCodePosition: 0,\n          });\n        }\n      }\n      !e.altKey && this.disablePickColor();\n    });\n  }\n\n  enablePickColor() {\n    this.setState(\n      {\n        pickingColor: true,\n      },\n      () => {\n        this.renderCanvas();\n      }\n    );\n  }\n\n  disablePickColor() {\n    this.setState(\n      {\n        pickingColor: false,\n      },\n      () => {\n        this.renderCanvas();\n      }\n    );\n  }\n\n  pickColor(cell) {\n    if (!this.state.signedIn || !this._lines || !this._lines[cell.y]) {\n      return;\n    }\n    const color = this._lines[cell.y][cell.x].color;\n\n    this.setState(\n      {\n        currentColor: color,\n        alpha: 1,\n        pickerColor: intToColorWithAlpha(color, 1),\n        gammaColors: generateGamma(int2hsv(color)[0]),\n        pickingColor: false,\n      },\n      () => {\n        this.renderCanvas();\n      }\n    );\n  }\n\n  async _sendQueue() {\n    const pixels = this._queue.slice(0, BatchOfPixels);\n    this._queue = this._queue.slice(BatchOfPixels);\n    this._pendingPixels = pixels;\n\n    try {\n      await this._contract.draw(\n        {\n          pixels,\n        },\n        new BN(\"75000000000000\")\n      );\n      this._numFailedTxs = 0;\n    } catch (error) {\n      console.log(\"Failed to send a transaction\", error);\n      this._numFailedTxs += 1;\n      if (this._numFailedTxs < 3) {\n        this._queue = this._queue.concat(this._pendingPixels);\n        this._pendingPixels = [];\n      } else {\n        this._pendingPixels = [];\n        this._queue = [];\n      }\n    }\n    try {\n      await Promise.all([this.refreshBoard(true), this.refreshAccountStats()]);\n    } catch (e) {\n      // ignore\n    }\n    this._pendingPixels.forEach((p) => {\n      if (this._pending[p.y][p.x] === p.color) {\n        this._pending[p.y][p.x] = -1;\n      }\n    });\n    this._pendingPixels = [];\n  }\n\n  async _pingQueue(ready) {\n    if (this._sendQueueTimer) {\n      clearTimeout(this._sendQueueTimer);\n      this._sendQueueTimer = null;\n    }\n\n    if (\n      this._pendingPixels.length === 0 &&\n      (this._queue.length >= BatchOfPixels || ready)\n    ) {\n      await this._sendQueue();\n    }\n    if (this._queue.length > 0) {\n      this._sendQueueTimer = setTimeout(async () => {\n        await this._pingQueue(true);\n      }, BatchTimeout);\n    }\n  }\n\n  async drawImg(cell) {\n    if (!this.state.signedIn || !this._lines || !this._lines[cell.y]) {\n      return;\n    }\n    const balance = this.state.account ? this.state.account.avocadoBalance : 0;\n\n    if (\n      !this._isFreeDrawing() &&\n      balance - this.state.pendingPixels < this.state.avocadoNeeded\n    ) {\n      return;\n    }\n\n    const img = this.imageData;\n    const w = img.width;\n    const h = img.height;\n    const x = cell.x - Math.trunc(w / 2);\n    const y = cell.y - Math.trunc(h / 2);\n    const d = new Uint32Array(this.imageData.data.buffer);\n    for (let i = 0; i < h; ++i) {\n      for (let j = 0; j < w; ++j) {\n        const imgColor = d[i * w + j];\n        if (\n          imgColor &&\n          y + i >= 0 &&\n          y + i < BoardHeight &&\n          x + j >= 0 &&\n          x + j < BoardWidth\n        ) {\n          const bgColor = this._lines[y + i]\n            ? this._lines[y + i][x + j].color\n            : 0;\n          const color = imgColorToInt(imgColor, bgColor);\n          if (color !== bgColor) {\n            this._queue.push({\n              x: x + j,\n              y: y + i,\n              color,\n            });\n          }\n        }\n      }\n    }\n    this.setState({\n      rendering: false,\n    });\n\n    this._stopRefreshTime = new Date().getTime() + MaxWorkTime;\n    await this._pingQueue(false);\n  }\n\n  async drawPixel(cell) {\n    if (!this.state.signedIn || !this._lines || !this._lines[cell.y]) {\n      return;\n    }\n    const balance = this.state.account ? this.state.account.avocadoBalance : 0;\n    if (!this._isFreeDrawing() && balance - this.state.pendingPixels < 1) {\n      return;\n    }\n\n    const bgColor = this._lines[cell.y] ? this._lines[cell.y][cell.x].color : 0;\n    const cb = this.state.currentColor & 255;\n    const cg = (this.state.currentColor >> 8) & 255;\n    const cr = (this.state.currentColor >> 16) & 255;\n    const color = rgbaToInt(cr, cg, cb, this.state.alpha, bgColor);\n\n    if (\n      this._pending[cell.y][cell.x] !== color &&\n      this._lines[cell.y][cell.x].color !== color\n    ) {\n      this._pending[cell.y][cell.x] = color;\n    } else {\n      return;\n    }\n\n    this._queue.push({\n      x: cell.x,\n      y: cell.y,\n      color,\n    });\n\n    this._stopRefreshTime = new Date().getTime() + MaxWorkTime;\n    await this._pingQueue(false);\n  }\n\n  parseAccount(account, accountId) {\n    if (!account) {\n      account = {\n        accountId,\n        accountIndex: -1,\n        avocadoBalance: 25.0,\n        bananaBalance: 0.0,\n        numPixels: 0,\n        farmingPreference: Berry.Avocado,\n      };\n    } else {\n      account = {\n        accountId: account.account_id,\n        accountIndex: account.account_index,\n        avocadoBalance: parseFloat(account.avocado_balance) / this._pixelCost,\n        bananaBalance: parseFloat(account.banana_balance) / this._pixelCost,\n        numPixels: account.num_pixels,\n        farmingPreference: account.farming_preference,\n      };\n    }\n    account.startTime = new Date().getTime();\n    account.avocadoPixels =\n      account.farmingPreference === Berry.Avocado ? account.numPixels + 1 : 0;\n    account.bananaPixels =\n      account.farmingPreference === Berry.Banana ? account.numPixels : 0;\n    account.avocadoRewardPerMs = account.avocadoPixels / (24 * 60 * 60 * 1000);\n    account.bananaRewardPerMs = account.bananaPixels / (24 * 60 * 60 * 1000);\n    return account;\n  }\n\n  async getAccount(accountId) {\n    return this.parseAccount(\n      await this._contract.get_account({ account_id: accountId }),\n      accountId\n    );\n  }\n\n  async getAccountByIndex(accountIndex) {\n    return this.parseAccount(\n      await this._contract.get_account_by_index({\n        account_index: accountIndex,\n      }),\n      \"unknown\"\n    );\n  }\n\n  async refreshAccountStats() {\n    let account = await this.getAccount(this._accountId);\n    if (this._balanceRefreshTimer) {\n      clearInterval(this._balanceRefreshTimer);\n      this._balanceRefreshTimer = null;\n    }\n\n    this.setState({\n      pendingPixels: this._pendingPixels.length + this._queue.length,\n      farmingBanana: account.farmingPreference === Berry.Banana,\n      account,\n    });\n\n    this._balanceRefreshTimer = setInterval(() => {\n      const t = new Date().getTime() - account.startTime;\n      this.setState({\n        account: Object.assign({}, account, {\n          avocadoBalance:\n            account.avocadoBalance + t * account.avocadoRewardPerMs,\n          bananaBalance: account.bananaBalance + t * account.bananaRewardPerMs,\n        }),\n        pendingPixels: this._pendingPixels.length + this._queue.length,\n      });\n    }, 100);\n  }\n\n  async _initNear() {\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearAPI.connect(\n      Object.assign({ deps: { keyStore } }, NearConfig)\n    );\n    this._keyStore = keyStore;\n    this._near = near;\n\n    this._walletConnection = new nearAPI.WalletConnection(\n      near,\n      NearConfig.contractName\n    );\n    this._accountId = this._walletConnection.getAccountId();\n\n    this._account = this._walletConnection.account();\n    this._contract = new nearAPI.Contract(\n      this._account,\n      NearConfig.contractName,\n      {\n        viewMethods: [\n          \"get_account\",\n          \"get_account_by_index\",\n          \"get_lines\",\n          \"get_line_versions\",\n          \"get_pixel_cost\",\n          \"get_account_balance\",\n          \"get_account_num_pixels\",\n          \"get_account_id_by_index\",\n          \"get_free_drawing_timestamp\",\n        ],\n        changeMethods: [\"draw\", \"buy_tokens\", \"select_farming_preference\"],\n      }\n    );\n    this._pixelCost = parseFloat(await this._contract.get_pixel_cost());\n    const freeDrawingTimestamp = await this._contract.get_free_drawing_timestamp();\n    this._freeDrawingStart = new Date(freeDrawingTimestamp);\n    this._freeDrawingEnd = new Date(freeDrawingTimestamp + OneDayMs);\n    if (this._accountId) {\n      await this.refreshAccountStats();\n    }\n    this._lineVersions = Array(BoardHeight).fill(-1);\n    this._lines = Array(BoardHeight).fill(false);\n    this._pending = Array(BoardHeight).fill(false);\n    this._pending.forEach((v, i, a) => (a[i] = Array(BoardWidth).fill(-1)));\n    await this.refreshBoard(true);\n  }\n\n  async refreshBoard(forced) {\n    if (this._refreshBoardTimer) {\n      clearTimeout(this._refreshBoardTimer);\n      this._refreshBoardTimer = null;\n    }\n    const t = new Date().getTime();\n    if (this.state.watchMode || t < this._stopRefreshTime) {\n      this._refreshBoardTimer = setTimeout(async () => {\n        await this.refreshBoard(false);\n      }, RefreshBoardTimeout);\n    }\n\n    if (!forced && document.hidden) {\n      return;\n    }\n\n    let lineVersions = await this._contract.get_line_versions();\n    let needLines = [];\n    for (let i = 0; i < BoardHeight; ++i) {\n      if (lineVersions[i] !== this._lineVersions[i]) {\n        needLines.push(i);\n      }\n    }\n    let requestLines = [];\n    for (let i = 0; i < needLines.length; i += NumLinesPerFetch) {\n      requestLines.push(needLines.slice(i, i + NumLinesPerFetch));\n    }\n\n    let results = await Promise.all(\n      requestLines.map((lines) => this._contract.get_lines({ lines }))\n    );\n    results = results.flat();\n    requestLines = requestLines.flat();\n    for (let i = 0; i < requestLines.length; ++i) {\n      let lineIndex = requestLines[i];\n      let line = decodeLine(results[i]);\n      this._lines[lineIndex] = line;\n    }\n\n    this._lineVersions = lineVersions;\n    this._refreshOwners();\n    this.renderCanvas();\n  }\n\n  _refreshOwners() {\n    const counts = {};\n    this._lines.flat().forEach((cell) => {\n      counts[cell.ownerIndex] = (counts[cell.ownerIndex] || 0) + 1;\n    });\n    delete counts[0];\n    const sortedKeys = Object.keys(counts).sort(\n      (a, b) => counts[b] - counts[a]\n    );\n    this.setState({\n      owners: sortedKeys.map((accountIndex) => {\n        accountIndex = parseInt(accountIndex);\n        return {\n          accountIndex,\n          numPixels: counts[accountIndex],\n        };\n      }),\n    });\n    sortedKeys.forEach(async (accountIndex) => {\n      accountIndex = parseInt(accountIndex);\n      if (\n        !(accountIndex in this._accounts) ||\n        counts[accountIndex] !== (this._oldCounts[accountIndex] || 0)\n      ) {\n        try {\n          this._accounts[accountIndex] = await this.getAccountByIndex(\n            accountIndex\n          );\n        } catch (err) {\n          console.log(\"Failed to fetch account index #\", accountIndex, err);\n        }\n        this.setState({\n          accounts: Object.assign({}, this._accounts),\n        });\n      }\n    });\n    this.setState({\n      accounts: Object.assign({}, this._accounts),\n    });\n    this._oldCounts = counts;\n  }\n\n  renderCanvas() {\n    if (!this._context || !this._lines) {\n      return;\n    }\n\n    const ctx = this._context;\n\n    for (let i = 0; i < BoardHeight; ++i) {\n      const line = this._lines[i];\n      if (!line) {\n        continue;\n      }\n      for (let j = 0; j < BoardWidth; ++j) {\n        const p = line[j];\n        ctx.fillStyle = intToColor(p.color);\n        ctx.fillRect(j * CellWidth, i * CellHeight, CellWidth, CellHeight);\n        if (this.state.highlightedAccountIndex >= 0) {\n          if (p.ownerIndex !== this.state.highlightedAccountIndex) {\n            ctx.fillStyle = \"rgba(32, 32, 32, 0.8)\";\n            ctx.fillRect(\n              j * CellWidth,\n              i * CellHeight,\n              CellWidth / 2,\n              CellHeight / 2\n            );\n            ctx.fillRect(\n              (j + 0.5) * CellWidth,\n              (i + 0.5) * CellHeight,\n              CellWidth / 2,\n              CellHeight / 2\n            );\n            ctx.fillStyle = \"rgba(0, 0, 0, 0.8)\";\n            ctx.fillRect(\n              j * CellWidth,\n              (i + 0.5) * CellHeight,\n              CellWidth / 2,\n              CellHeight / 2\n            );\n            ctx.fillRect(\n              (j + 0.5) * CellWidth,\n              i * CellHeight,\n              CellWidth / 2,\n              CellHeight / 2\n            );\n          } else {\n            ctx.beginPath();\n            ctx.strokeStyle = ctx.fillStyle = \"rgba(255, 255, 255, 0.8)\";\n            ctx.lineWidth = 0.5;\n            ctx.rect(\n              j * CellWidth + 0.5,\n              i * CellHeight + 0.5,\n              CellWidth - 1,\n              CellHeight - 1\n            );\n            ctx.stroke();\n            ctx.closePath();\n          }\n        }\n      }\n    }\n\n    this._pendingPixels.concat(this._queue).forEach((p) => {\n      ctx.fillStyle = intToColor(p.color);\n      ctx.fillRect(p.x * CellWidth, p.y * CellHeight, CellWidth, CellHeight);\n    });\n\n    if (this.state.selectedCell && !this.state.watchMode) {\n      const c = this.state.selectedCell;\n      if (this.state.rendering) {\n        const img = this.imageData;\n        const w = img.width;\n        const h = img.height;\n        const x = c.x - Math.trunc(w / 2);\n        const y = c.y - Math.trunc(h / 2);\n        const d = new Uint32Array(this.imageData.data.buffer);\n        for (let i = 0; i < h; ++i) {\n          for (let j = 0; j < w; ++j) {\n            const color = d[i * w + j];\n            if (\n              color &&\n              y + i >= 0 &&\n              y + i < BoardHeight &&\n              x + j >= 0 &&\n              x + j < BoardWidth\n            ) {\n              const bgColor = this._lines[y + i]\n                ? this._lines[y + i][x + j].color\n                : 0;\n              ctx.fillStyle = intToColor(imgColorToInt(color, bgColor));\n              ctx.fillRect(\n                (x + j) * CellWidth,\n                (y + i) * CellHeight,\n                CellWidth,\n                CellHeight\n              );\n            }\n          }\n        }\n      } else if (this.state.pickingColor) {\n        const color = this._lines[c.y] ? this._lines[c.y][c.x].color : 0;\n        ctx.beginPath();\n        ctx.strokeStyle = ctx.fillStyle = transparentColor(color, 0.5);\n        ctx.lineWidth = CellWidth * 4;\n        ctx.arc(\n          (c.x + 0.5) * CellWidth,\n          (c.y + 0.5) * CellHeight,\n          CellWidth * 4,\n          0,\n          2 * Math.PI\n        );\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.strokeStyle = ctx.fillStyle = transparentColor(color, 1);\n        ctx.lineWidth = CellWidth * 2;\n        ctx.arc(\n          (c.x + 0.5) * CellWidth,\n          (c.y + 0.5) * CellHeight,\n          CellWidth * 4,\n          0,\n          2 * Math.PI\n        );\n        ctx.stroke();\n        ctx.closePath();\n      } else {\n        ctx.fillStyle = transparentColor(this.state.currentColor, 0.2);\n        ctx.fillRect(c.x * CellWidth, 0, CellWidth, c.y * CellHeight);\n        ctx.fillRect(\n          c.x * CellWidth,\n          (c.y + 1) * CellHeight,\n          CellWidth,\n          (BoardHeight - c.y - 1) * CellHeight\n        );\n        ctx.fillRect(0, c.y * CellHeight, c.x * CellWidth, CellHeight);\n        ctx.fillRect(\n          (c.x + 1) * CellWidth,\n          c.y * CellHeight,\n          (BoardWidth - c.x - 1) * CellWidth,\n          CellHeight\n        );\n\n        ctx.beginPath();\n        ctx.lineWidth = 3;\n        ctx.fillStyle = intToColor(this.state.currentColor);\n        ctx.strokeStyle = intToColor(this.state.currentColor);\n        ctx.rect(c.x * CellWidth, c.y * CellHeight, CellWidth, CellHeight);\n        ctx.stroke();\n        ctx.closePath();\n      }\n    }\n\n    if (!this.state.boardLoaded) {\n      this.setState({\n        boardLoaded: true,\n      });\n    }\n  }\n\n  async requestSignIn() {\n    const appTitle = \"Berry Club\";\n    await this._walletConnection.requestSignIn(\n      NearConfig.contractName,\n      appTitle\n    );\n  }\n\n  async logOut() {\n    this._walletConnection.signOut();\n    this._accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      accountId: this._accountId,\n    });\n  }\n\n  async alphaColorChange(c) {\n    this.setState(\n      {\n        alpha: c.rgb.a,\n      },\n      () => {\n        this.changeColor(c, c.rgb.a);\n      }\n    );\n  }\n\n  hueColorChange(c) {\n    this.setState({\n      gammaColors: generateGamma(c.hsl.h),\n    });\n    this.changeColor(c);\n  }\n\n  saveColor() {\n    const newColor = intToColor(this.state.currentColor);\n    const index = this.state.colors.indexOf(newColor);\n    if (index >= 0) {\n      this.state.colors.splice(index, 1);\n    }\n    this.setState({\n      colors: [newColor].concat(this.state.colors).slice(0, MaxNumColors),\n    });\n  }\n\n  changeColor(c, alpha) {\n    alpha = alpha || 1.0;\n    const currentColor = c.rgb.r * 0x010000 + c.rgb.g * 0x000100 + c.rgb.b;\n    c.hex = intToColorWithAlpha(currentColor, alpha);\n    c.rgb.a = alpha;\n    c.hsl.a = alpha;\n    c.hsv.a = alpha;\n    this.setState(\n      {\n        pickerColor: c,\n        alpha,\n        currentColor,\n      },\n      () => {\n        this.renderCanvas();\n      }\n    );\n  }\n\n  async buyTokens(amount) {\n    const requiredBalance = PixelPrice.muln(amount);\n    await this._contract.buy_tokens(\n      {},\n      new BN(\"30000000000000\"),\n      requiredBalance\n    );\n  }\n\n  setHover(accountIndex, v) {\n    if (v) {\n      this.setState(\n        {\n          highlightedAccountIndex: accountIndex,\n        },\n        () => {\n          this.renderCanvas();\n        }\n      );\n    } else if (this.state.highlightedAccountIndex === accountIndex) {\n      this.setState(\n        {\n          highlightedAccountIndex: -1,\n        },\n        () => {\n          this.renderCanvas();\n        }\n      );\n    }\n  }\n\n  async switchBerry(farmingBanana) {\n    this.setState({\n      farmingBanana,\n    });\n    await this._contract.select_farming_preference({\n      berry: farmingBanana ? Berry.Banana : Berry.Avocado,\n    });\n    await this.refreshAccountStats();\n  }\n\n  async renderImg(img, avocadoNeeded) {\n    this.imageData = img;\n    this.setState({\n      weaponsOn: false,\n      weaponsCodePosition: 0,\n      rendering: true,\n      pickingColor: false,\n      avocadoNeeded,\n    });\n  }\n\n  _isFreeDrawing() {\n    const date = new Date();\n    return (\n      this.state.freeDrawingStart <= date && date < this.state.freeDrawingEnd\n    );\n  }\n\n  enableWatchMode() {\n    this.setState({\n      watchMode: true,\n      weaponsOn: false,\n      weaponsCodePosition: 0,\n    });\n    document.body.style.transition = \"3s\";\n    document.body.style.backgroundColor = \"#333\";\n  }\n\n  render() {\n    const watchClass = this.state.watchMode ? \" hidden\" : \"\";\n    const isFreeDrawing = this._isFreeDrawing();\n    const freeDrawing = (\n      <div\n        className={`free-drawing ${\n          isFreeDrawing ? \"free\" : \"wait\"\n        }${watchClass}`}\n      >\n        {isFreeDrawing\n          ? \"BANANZA!!! Draw for free \"\n          : \"Time until free drawing \"}\n        <Timer\n          initialTime={\n            isFreeDrawing\n              ? this.state.freeDrawingEnd - new Date()\n              : this.state.freeDrawingStart - new Date()\n          }\n          direction=\"backward\"\n          timeToUpdate={100}\n          lastUnit=\"d\"\n          checkpoints={[\n            {\n              time: 0,\n            },\n          ]}\n        >\n          {() => (\n            <React.Fragment>\n              <Timer.Days\n                formatValue={(v) => (v > 1 ? `${v} days ` : v ? `1 day ` : \"\")}\n              />\n              <Timer.Hours />:\n              <Timer.Minutes formatValue={(v) => `${v}`.padStart(2, \"0\")} />:\n              <Timer.Seconds formatValue={(v) => `${v}`.padStart(2, \"0\")} />.\n              <Timer.Milliseconds\n                formatValue={(v) => `${v}`.padStart(3, \"0\")}\n              />\n            </React.Fragment>\n          )}\n        </Timer>\n      </div>\n    );\n\n    const content = !this.state.connected ? (\n      <div>\n        Connecting...{\" \"}\n        <span\n          className=\"spinner-grow spinner-grow-sm\"\n          role=\"status\"\n          aria-hidden=\"true\"\n        />\n      </div>\n    ) : this.state.signedIn ? (\n      <div>\n        <div className={`float-right${watchClass}`}>\n          <button\n            className=\"btn btn-outline-secondary\"\n            onClick={() => this.logOut()}\n          >\n            Log out ({this.state.accountId})\n          </button>\n        </div>\n        {freeDrawing}\n        <div className={`your-balance${watchClass}`}>\n          Balance:{\" \"}\n          <Balance\n            account={this.state.account}\n            pendingPixels={this.state.pendingPixels}\n            isFreeDrawing={isFreeDrawing}\n            detailed={true}\n          />\n          <div>\n            Farming preference:\n            <Switch\n              onChange={(e) => this.switchBerry(e)}\n              checked={this.state.farmingBanana}\n              className=\"react-switch\"\n              height={30}\n              width={70}\n              offColor=\"#666\"\n              onColor=\"#666\"\n              uncheckedIcon={\n                <div className=\"switch-berry avocado\">{Avocado}</div>\n              }\n              checkedIcon={<div className=\"switch-berry banana\">{Banana}</div>}\n            />\n          </div>\n        </div>\n        <div className={`buttons${watchClass}`}>\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => this.buyTokens(10)}\n          >\n            Buy <span className=\"font-weight-bold\">25{Avocado}</span> for{\" \"}\n            <span className=\"font-weight-bold\">‚ìÉ0.1</span>\n          </button>{\" \"}\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => this.buyTokens(40)}\n          >\n            Buy <span className=\"font-weight-bold\">100{Avocado}</span> for{\" \"}\n            <span className=\"font-weight-bold\">‚ìÉ0.4</span>\n          </button>{\" \"}\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => this.buyTokens(100)}\n          >\n            Buy <span className=\"font-weight-bold\">250{Avocado}</span> for{\" \"}\n            <span className=\"font-weight-bold\">‚ìÉ1</span>\n          </button>{\" \"}\n          <button\n            className=\"btn btn-success\"\n            onClick={() => this.buyTokens(500)}\n          >\n            DEAL: Buy <span className=\"font-weight-bold\">1500{Avocado}</span>{\" \"}\n            for <span className=\"font-weight-bold\">‚ìÉ5</span>\n          </button>\n        </div>\n        <div className={`color-picker${watchClass}`}>\n          <HuePicker\n            color={this.state.pickerColor}\n            width=\"100%\"\n            onChange={(c) => this.hueColorChange(c)}\n          />\n          <AlphaPicker\n            color={this.state.pickerColor}\n            width=\"100%\"\n            onChange={(c) => this.alphaColorChange(c)}\n          />\n          <div\n            className={this.state.alpha >= 0.75 ? \"display-warning\" : \"hidden\"}\n          >\n            <span role=\"img\" aria-label=\"warning\">\n              ‚ö†Ô∏è\n            </span>\n            Ô∏è Please! Don't destroy art! If you just want to farm {Banana}, just\n            draw with low opacity.\n            <span role=\"img\" aria-label=\"pray\">\n              üôè\n            </span>\n            Ô∏è\n          </div>\n          <GithubPicker\n            className=\"circle-picker\"\n            colors={this.state.gammaColors}\n            color={this.state.pickerColor}\n            triangle=\"hide\"\n            width=\"100%\"\n            onChangeComplete={(c) => this.changeColor(c)}\n          />\n          <GithubPicker\n            className=\"circle-picker\"\n            colors={this.state.colors}\n            color={this.state.pickerColor}\n            triangle=\"hide\"\n            width=\"100%\"\n            onChangeComplete={(c) => this.hueColorChange(c)}\n          />\n        </div>\n      </div>\n    ) : (\n      <div style={{ marginBottom: \"10px\" }}>\n        {freeDrawing}\n        <div>\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => this.requestSignIn()}\n          >\n            Log in with NEAR Wallet\n          </button>\n        </div>\n      </div>\n    );\n    const weapons = this.state.weaponsOn ? (\n      <div>\n        <Weapons\n          account={this.state.account}\n          isFreeDrawing={isFreeDrawing}\n          renderIt={(img, avocadoNeeded) => this.renderImg(img, avocadoNeeded)}\n          enableWatchMode={() => this.enableWatchMode()}\n        />\n      </div>\n    ) : (\n      \"\"\n    );\n    return (\n      <div>\n        <div className={`header${watchClass}`}>\n          <h2>\n            {Avocado} Berry Club {Banana}\n          </h2>{\" \"}\n          <a className=\"btn btn-outline-none\" href=\"https://farm.berryclub.io\">\n            Berry Farm {Cucumber}\n          </a>\n          <a\n            className=\"btn btn-outline-none\"\n            href=\"https://app.ref.finance/#wrap.near|berryclub.ek.near\"\n          >\n            REF Finance {Banana}\n          </a>\n          <a className=\"btn btn-outline-none\" href=\"https://berry.cards\">\n            [BETA] Berry Cards {Pepper}\n          </a>\n          {content}\n        </div>\n        <div className=\"container\">\n          <div className=\"row\">\n            <div>\n              <div>\n                <canvas\n                  ref={this.canvasRef}\n                  width={600}\n                  height={600}\n                  className={\n                    this.state.boardLoaded\n                      ? `pixel-board${\n                          this.state.watchMode ? \" watch-mode\" : \"\"\n                        }`\n                      : \"pixel-board c-animated-background\"\n                  }\n                />\n              </div>\n            </div>\n            <div className={`leaderboard${watchClass}`}>\n              <div>\n                <Leaderboard\n                  owners={this.state.owners}\n                  accounts={this.state.accounts}\n                  setHover={(accountIndex, v) => this.setHover(accountIndex, v)}\n                  selectedOwnerIndex={this.state.selectedOwnerIndex}\n                  highlightedAccountIndex={this.state.highlightedAccountIndex}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className={`padded${watchClass}`}>\n          {this.state.signedIn ? (\n            <div>\n              <iframe\n                title=\"irc\"\n                className=\"irc\"\n                frameBorder=\"0\"\n                src={`https://kiwiirc.com/client/irc.kiwiirc.com/?nick=${this.state.ircAccountId}#berryclub`}\n              />\n            </div>\n          ) : (\n            \"\"\n          )}\n        </div>\n        <div className={`padded${watchClass}`}>\n          <div className=\"video-container\">\n            <iframe\n              title=\"youtube3\"\n              className=\"youtube\"\n              src=\"https://www.youtube.com/embed/wfTa-Kgw2DM\"\n              frameBorder=\"0\"\n              allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n              allowFullScreen\n            />\n          </div>\n        </div>\n        <div className={`padded${watchClass}`}>\n          <div className=\"video-container\">\n            <iframe\n              title=\"youtube2\"\n              className=\"youtube\"\n              src=\"https://www.youtube.com/embed/PYF6RWd7ZgI\"\n              frameBorder=\"0\"\n              allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n              allowFullScreen\n            />\n          </div>\n        </div>\n        <div className={`padded${watchClass}`}>\n          <div className=\"video-container\">\n            <iframe\n              title=\"youtube\"\n              className=\"youtube\"\n              src=\"https://www.youtube.com/embed/lMSWhCwstLo\"\n              frameBorder=\"0\"\n              allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n              allowFullScreen\n            />\n          </div>\n        </div>\n        {weapons}\n        <a\n          className={`github-fork-ribbon right-bottom fixed${watchClass}`}\n          href=\"https://github.com/evgenykuzyakov/berryclub\"\n          data-ribbon=\"Fork me on GitHub\"\n          title=\"Fork me on GitHub\"\n        >\n          Fork me on GitHub\n        </a>\n      </div>\n    );\n  }\n}\n\nconst Balance = (props) => {\n  const account = props.account;\n  if (!account) {\n    return \"\";\n  }\n  const fraction = props.detailed ? 3 : 1;\n  const avacadoBalance =\n    account.avocadoBalance -\n    (props.isFreeDrawing ? 0 : props.pendingPixels || 0);\n  const avocadoFarm =\n    account.avocadoPixels > 0 ? (\n      <span>\n        {\"(+\"}\n        <span className=\"font-weight-bold\">{account.avocadoPixels}</span>\n        {Avocado}\n        {\"/day)\"}\n      </span>\n    ) : (\n      \"\"\n    );\n  const bananaFarm =\n    account.bananaPixels > 0 ? (\n      <span>\n        {\"(+\"}\n        <span className=\"font-weight-bold\">{account.bananaPixels}</span>\n        {Banana}\n        {\"/day)\"}\n      </span>\n    ) : (\n      \"\"\n    );\n  return (\n    <span className=\"balances font-small\">\n      <span className=\"font-weight-bold\">\n        {avacadoBalance.toFixed(fraction)}\n      </span>\n      {Avocado}{\" \"}\n      <span className=\"font-weight-bold\">\n        {account.bananaBalance.toFixed(fraction)}\n      </span>\n      {Banana} {avocadoFarm}\n      {bananaFarm}\n      {props.pendingPixels ? <span> ({props.pendingPixels} pending)</span> : \"\"}\n    </span>\n  );\n};\n\nconst Leaderboard = (props) => {\n  const owners = props.owners.map((owner) => {\n    if (owner.accountIndex in props.accounts) {\n      owner.account = props.accounts[owner.accountIndex];\n    }\n    return (\n      <Owner\n        key={owner.accountIndex}\n        {...owner}\n        isSelected={owner.accountIndex === props.selectedOwnerIndex}\n        setHover={(v) => props.setHover(owner.accountIndex, v)}\n        isHighlighted={owner.accountIndex === props.highlightedAccountIndex}\n      />\n    );\n  });\n  return (\n    <table className=\"table table-hover table-sm\">\n      <tbody>{owners}</tbody>\n    </table>\n  );\n};\n\nconst Owner = (props) => {\n  const account = props.account;\n  return (\n    <tr\n      onMouseEnter={() => props.setHover(true)}\n      onMouseLeave={() => props.setHover(false)}\n      className={props.isSelected ? \"selected\" : \"\"}\n    >\n      <td>{account ? <Account accountId={account.accountId} /> : \"...\"}</td>\n      <td className=\"text-nowrap\">\n        <small>\n          <Balance account={account} />\n        </small>\n      </td>\n    </tr>\n  );\n};\n\nconst Account = (props) => {\n  const accountId = props.accountId;\n  const shortAccountId =\n    accountId.length > 6 + 6 + 3\n      ? accountId.slice(0, 6) + \"...\" + accountId.slice(-6)\n      : accountId;\n  return (\n    <a className=\"account\" href={`https://wayback.berryclub.io/${accountId}`}>\n      {shortAccountId}\n    </a>\n  );\n};\n\nexport default App;\n","import \"./Weapons.scss\";\nimport React from \"react\";\nimport Files from \"react-files\";\n\nconst Avocado = (\n  <span role=\"img\" aria-label=\"avocado\" className=\"berry\">\n    ü•ë\n  </span>\n);\n\nexport class Weapons extends React.Component {\n  constructor(props) {\n    super(props);\n    this.canvasRef = React.createRef();\n    this.state = {\n      width: 48,\n      height: 28,\n      avocadoNeeded: 100,\n      lockedAspect: true,\n    };\n  }\n\n  componentDidMount() {\n    this.canvas = this.canvasRef.current;\n    this.ctx = this.canvas.getContext(\"2d\");\n    this.sourceImage = new Image();\n    this.sourceImage.onload = () => {\n      this.draw();\n    };\n    this.sourceImage.src = \"/bfg.png\";\n  }\n\n  draw() {\n    const sourceImage = this.sourceImage;\n    const canvas = this.canvas;\n    const ctx = this.ctx;\n    const width = this.state.width;\n    const height = this.state.height;\n\n    // Create a canvas with the desired dimensions\n    canvas.width = width;\n    canvas.height = height;\n    canvas.style.width = width * 10 + \"px\";\n    canvas.style.height = height * 10 + \"px\";\n\n    // Scale and draw the source image to the canvas\n    ctx.clearRect(0, 0, width, height);\n    ctx.imageSmoothingQuality = \"low\";\n    ctx.drawImage(sourceImage, 0, 0, width, height);\n\n    const imageData = ctx.getImageData(0, 0, width, height);\n    this.imageData = imageData;\n    this.setState({\n      avocadoNeeded: new Uint32Array(imageData.data.buffer).reduce(\n        (sum, v) => sum + (v ? 1 : 0),\n        0\n      ),\n    });\n  }\n\n  async onFilesChange(f) {\n    const sourceImage = this.sourceImage;\n    let reader = new FileReader();\n\n    reader.readAsDataURL(f[0]);\n\n    sourceImage.onload = () => {\n      let width = sourceImage.naturalWidth;\n      let height = sourceImage.naturalHeight;\n      if (sourceImage.naturalWidth > 50 || sourceImage.naturalHeight > 50) {\n        const aspect = width / height;\n        width = Math.round(20 * Math.min(1, aspect));\n        height = Math.round(20 * Math.min(1, 1 / aspect));\n      }\n      this.setState({\n        width: Math.min(50, Math.max(1, width)),\n        height: Math.min(50, Math.max(1, height)),\n      });\n      this.draw();\n    };\n\n    reader.onload = function (event) {\n      sourceImage.src = event.target.result;\n    };\n  }\n\n  async onFilesError(e, f) {\n    console.log(e, f);\n  }\n\n  updateVal(key, value) {\n    value = Math.min(50, Math.max(1, value));\n    if (this.state.lockedAspect) {\n      const aspect =\n        this.sourceImage.naturalWidth / this.sourceImage.naturalHeight;\n      let width, height;\n      if (key === \"width\") {\n        width = value;\n        height = Math.round(width / aspect);\n      } else {\n        height = value;\n        width = Math.round(height * aspect);\n      }\n      this.setState(\n        {\n          width: Math.min(50, Math.max(1, width)),\n          height: Math.min(50, Math.max(1, height)),\n        },\n        () => {\n          this.draw();\n        }\n      );\n    } else {\n      this.setState(\n        {\n          [key]: value,\n        },\n        () => {\n          this.draw();\n        }\n      );\n    }\n  }\n\n  changeLockedAspect() {\n    this.setState({\n      lockedAspect: !this.state.lockedAspect,\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"weapons-popup\">\n        <div className=\"weapons-content\">\n          <h2>So you need a BFG?</h2>\n          <div>\n            <Files\n              type=\"button\"\n              className=\"btn\"\n              onChange={(f) => this.onFilesChange(f)}\n              onError={(e, f) => this.onFilesError(e, f)}\n              multiple={false}\n              accepts={[\"image/*\"]}\n              minFileSize={1}\n              clickable\n            >\n              Click to upload an image\n            </Files>\n          </div>\n          <div>\n            <label>Width</label>\n            <input\n              type=\"number\"\n              value={this.state.width}\n              min={1}\n              max={50}\n              onChange={(e) => this.updateVal(\"width\", e.target.value)}\n            />{\" \"}\n            <button\n              className={\n                \"btn btn-outline-secondary low-right-margin\" +\n                (this.state.lockedAspect ? \" btn-pressed\" : \" btn-not-pressed\")\n              }\n              onClick={() => this.changeLockedAspect()}\n            >\n              <span role=\"img\" aria-label=\"link\" className=\"berry\">\n                üîó\n              </span>\n            </button>\n            <label>Height</label>\n            <input\n              type=\"number\"\n              value={this.state.height}\n              min={1}\n              max={50}\n              onChange={(e) => this.updateVal(\"height\", e.target.value)}\n            />\n          </div>\n          <button\n            className=\"btn btn-success btn-large\"\n            disabled={\n              !this.props.account ||\n              (!this.props.isFreeDrawing &&\n                this.props.account.avocadoBalance < this.state.avocadoNeeded)\n            }\n            onClick={() =>\n              this.props.renderIt(this.imageData, this.state.avocadoNeeded)\n            }\n          >\n            Render on the board using {this.state.avocadoNeeded} {Avocado}\n          </button>\n          <button\n            className=\"btn btn-primary btn-large\"\n            onClick={() => this.props.enableWatchMode()}\n          >\n            Enable watch mode\n          </button>\n          <div className=\"canvas-wrapper\">\n            <canvas\n              ref={this.canvasRef}\n              width={480}\n              height={280}\n              className=\"draw-preview\"\n            ></canvas>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}